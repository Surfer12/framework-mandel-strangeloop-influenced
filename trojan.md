Got it, Ryan. I’ll look into the likelihood of Trojan:Win32/Wacatac persisting on Sandisk G40 Thunderbolt 3 drives and CalDigit Thunderbolt 4 Element Hubs after full formats, diskpart cleans, and official firmware reflashing—specifically focusing on risks tied to firmware-level or filesystem-level infections. I’ll also include guidance on whether it’s safe to transition usage to macOS.

I’ll get back to you shortly with a clear, evidence-based summary.

# Risk of Trojan:Win32/Wacatac Persistence on External SSDs and Thunderbolt Hubs

## Trojan:Win32/Wacatac – Capabilities and Behavior
Trojan:Win32/Wacatac is a generic detection name used by Microsoft Defender for a broad category of Windows trojans ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Being%20a%20generic%20trojan%20detection%2C,specific%20trojan%20aliases)). It isn’t a single defined malware family, but rather a label for many malicious programs (often found in email attachments, crack downloads, etc.) that exhibit trojan-like behavior ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Wacatac%20Wacatac%20is%20a%20generic,a%20software%20patch%20or%20crack)). Once on a system, Wacatac-type malware can perform various malicious actions at the OS level. For example, it may steal sensitive data like passwords or banking details, download and install additional malware, open backdoors for remote access, or even add the computer to a botnet ([Wacatac Trojan - Malware removal instructions (updated)](https://www.pcrisk.com/removal-guides/15409-wacatac-trojan#:~:text=These%20trojans%20can%20do%20extensive,as%20much%20revenue%20as%20possible)) ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Examples%20include%20gathering%20personal%20and,system%E2%80%99s%20IP%20address%20by%20connecting)). These trojans typically try to **persist** on the infected Windows system by copying themselves to a startup folder or creating autorun registry keys, ensuring they launch on each boot ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=The%20trojan%20usually%20copies%20itself,com)). They often drop files in common directories (e.g. `%APPDATA%`) and might perform reconnaissance (for instance, attempting to fetch the machine’s IP address) as part of their operation ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=The%20trojan%20usually%20copies%20itself,com)). Importantly, Wacatac and its variants target the Windows operating system – they are not designed to infect the macOS environment and have **no effect on Mac** unless Windows is being run via Boot Camp or a VM.

## Effectiveness of Performed Clean-Up Steps
The user has already taken thorough steps to remove any infection from the Sandisk G40 external SSD and the CalDigit Thunderbolt hub. Each of these remediation steps addresses a different potential persistence mechanism:

- **Full Disk Formats:** Multiple full formats of the external SSD essentially **wiped all data** from the drive. In modern Windows (Vista and later), a full format isn’t just removing file indices – it actually **writes zeros to the entire disk** surface ([Change in the behavior of the format command in Windows Vista and later versions - Windows Server | Microsoft Learn](https://learn.microsoft.com/en-us/previous-versions/troubleshoot/windows-server/format-command-not-write-zeros-to-disk#:~:text=The%20behavior%20of%20the%20format,a%20full%20format%20is%20performed)). This means any malicious files, boot sector viruses, or hidden partitions that may have been on the SSD were completely erased. After such overwriting, **no standard malware can survive** on the storage medium. (Older malware that hid in the Master Boot Record or in unpartitioned space would also be removed by this action, as the formats were full and repeated.)

- **`diskpart clean` Command:** Using the `clean` command in DiskPart removes all partition information from the drive, including the MBR/GPT. This ensures that if any malware had created a hidden partition or bootloader (e.g. a rootkit in the boot sector), it is eliminated. A “clean” essentially returns the drive to an uninitialized state. (If `clean all` was used, it would go even further by zero-filling the entire drive, but in this case the full formats already accomplished that.) After a DiskPart clean, the SSD’s filesystem is gone, so any infection at the filesystem level is certainly gone as well.

- **Firmware Reflashing of the CalDigit Hub:** Reflashing the Thunderbolt hub’s firmware with the official CalDigit TS4/Element Hub firmware reinstalls the factory-default code on the device’s internal controller. This step addresses the unlikely scenario that malware had somehow modified the hub’s firmware. By applying the **official firmware image**, any unauthorized or malicious code that could have been persisting in the hub’s non-volatile memory would be overwritten. This restores the hub to a known-good state, as provided by the manufacturer.

- **Antivirus Scans (Windows Defender and Malwarebytes):** Running reputable security scanners on the system (with the devices attached) yielded no further detections. Windows Security (Defender) and Malwarebytes are effective at finding known Wacatac signatures or remnants in the filesystem. The fact that they **no longer detect Trojan:Win32/Wacatac** after the above steps is a strong indicator that the active infection has been removed. (It’s worth noting that sometimes Defender’s Wacatac alerts can be triggered by suspicious files that are not firmly entrenched malware ([Detected: Trojan:Win32/Wacatac.B!ml - Turtle WoW - Forums](https://forum.turtle-wow.org/viewtopic.php?t=1510#:~:text=wow,a%20number%20of%20malicious%20actions)). If those files are gone and scans are clean, the system and connected drives are likely clean.)

Together, these measures cover both **file-based and boot-level infection vectors**. At this point, it is highly likely that **no residual malware remains on the SSD’s filesystem or the hub**. The cleaning was comprehensive: even if the trojan had attempted typical persistence (startup folder or registry), those only affect the Windows OS installation (not the external devices themselves) ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=The%20trojan%20usually%20copies%20itself,com)). Formatting and cleaning the external disk removes any malicious files that were present on that disk, and reflashing the hub eliminates any chance of firmware tampering on that device.

## Can Wacatac Survive in Device Firmware?
The concern about malware lurking in device firmware (such as an SSD’s controller firmware or a Thunderbolt controller’s firmware) stems from the fact that **firmware-level infections** can survive efforts like disk formatting or OS reinstall. However, such infections are **extremely rare and associated with highly sophisticated threats**, not generic trojans like Wacatac. 

There are known examples of malware that persist in firmware, but they are typically the work of advanced threat actors or nation-state tools. For instance, the TrickBot malware family (a far more advanced threat) developed a module to infect a computer’s UEFI/BIOS firmware – this allowed it to survive even a complete hard drive reformat and OS reinstall ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=implant%20for%20persistence%20,trojan%20as%20a%20second%02stage%20payload)). Likewise, security researchers have demonstrated *proof-of-concept* attacks like “Thunderstrike 2” which can infect the firmware of Thunderbolt accessories and in turn spread to other computers’ firmware ([“Thunderstrike 2” rootkit uses Thunderbolt accessories to infect Mac ...](https://arstechnica.com/gadgets/2015/08/thunderstrike-2-rootkit-uses-thunderbolt-accessories-to-infect-mac-firmware/#:~:text=%E2%80%9CThunderstrike%202%E2%80%9D%20rootkit%20uses%20Thunderbolt,level%20malware%20is%20that)). These cases illustrate that firmware malware is possible, **but they are extraordinarily specialized**.

By contrast, **Trojan:Win32/Wacatac has no documented capability to infect firmware or hardware at that level**. Wacatac is a broad category of typical trojans that operate in the operating system user space (dropping files, altering OS settings, etc.), and it’s not associated with any specific APT group or ultra-advanced persistence techniques ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Being%20a%20generic%20trojan%20detection%2C,specific%20trojan%20aliases)). It primarily ensures its survival via OS mechanisms (like auto-start entries) rather than firmware implants. Reprogramming device firmware is a non-trivial task that malware would only undertake if it was specifically designed for stealth persistence and targeting. According to security experts, attacking something like a docking station or hub at the firmware level is *possible* in theory but “**may not be that easy**” and is generally not seen outside of targeted attacks on high-value targets ([firmware - I want to buy a used docking station for my laptop. Has there ever been a case of a docking station being a security concern? - Information Security Stack Exchange](https://security.stackexchange.com/questions/236510/i-want-to-buy-a-used-docking-station-for-my-laptop-has-there-ever-been-a-case-o#:~:text=While%20I%20have%20never%20looked,and%20capable%20of%20soldering%20wires)). In practice, a generic Windows trojan trying to rewrite the firmware of a Sandisk external SSD or a Thunderbolt hub would be highly unusual and is not something Wacatac is known for (no such behavior appears in its threat reports or analyses).

Given that the CalDigit hub’s firmware has been reflashed with official firmware, any hypothetical malware that *could* have been there is gone. As for the Sandisk G40 SSD, while SSD firmware malware is theoretically possible (there have been espionage cases where spy malware hid in hard drive firmware in the past), there is **no indication that Wacatac did anything like this**. Sandisk drives are not known to be prone to such attacks, and Wacatac would have no built-in functionality to silently flash the SSD’s controller. Firmware attacks tend to be the realm of extremely stealthy malware, not financially motivated trojans that typically seek to install ransomware or steal data via the OS.

In summary, the risk that **Trojan:Win32/Wacatac survived inside the firmware** of either the external SSD or the Thunderbolt hub is *negligible*. There have been **no reported cases of Wacatac infecting UEFI, SSD firmware, or peripheral firmware**, and the steps taken (drive wipe and firmware restore) would eradicate it in any case. As a supporting perspective, consider that if Wacatac had somehow been a firmware-level threat (again, very unlikely), the ordinary antivirus scans and formats would *not* have gotten rid of it – you would still see symptoms or detections. Since that’s not happening, it reinforces that Wacatac was confined to the Windows system and is now gone.

## Thunderbolt Device Security Best Practices
Thunderbolt devices (like the CalDigit hub and even the Thunderbolt-connected SSD) do introduce some unique security considerations, but these are mostly about **direct memory access (DMA)** and malicious device behavior rather than malware persisting on the device from a PC infection. The known Thunderbolt vulnerability “Thunderclap” demonstrated that a malicious Thunderbolt peripheral could theoretically access memory and compromise a system due to the privileged access Thunderbolt grants ([Thunderbolt 3 Security at Issue due to Thunderclap Threat – Stay Protected with CalDigit – CalDigit](https://www.caldigit.com/thunderbolt-3-security-at-issue-due-to-thunderclap-threat-stay-protected-with-caldigit/#:~:text=Thunderclap%20revealed%20that%20the%20Thunderbolt,files%2C%20or%20run%20malicious%20code)). Apple and Intel mitigated such issues by requiring user approval for new Thunderbolt devices and using an IOMMU (Memory protection). In fact, on modern Macs with Apple Silicon, when you plug in a new USB or Thunderbolt accessory, macOS will prompt you to allow the connection, adding a layer of protection against rogue devices ([If your Mac asks you to allow an accessory to connect - Apple Support](https://support.apple.com/en-us/102282#:~:text=Support%20support,laptop%20computer%20with%20Apple%20silicon)).

Given that your CalDigit Element/TS4 hub is a legitimate device and now running official firmware, it is **highly unlikely to be “rogue” or malicious**. Nevertheless, general best practices for Thunderbolt/USB devices are wise to follow:
- **Keep Device Firmware Updated:** You've done this for the hub, which is ideal. Manufacturers sometimes release firmware updates to patch security issues (for example, Dell had to patch vulnerabilities in its Thunderbolt dock firmware in 2020 ([DSA-2020-108: Dell Dock Firmware Update Utilities Arbitrary File ...](https://www.dell.com/support/kbdoc/en-us/000130238/dsa-2020-108-dell-dock-firmware-update-utilities-arbitrary-file-overwrite-vulnerability#:~:text=DSA,to%20fix))). Using the latest firmware means known exploits (like Thunderclap) are resolved ([Thunderbolt 3 Security at Issue due to Thunderclap Threat – Stay Protected with CalDigit – CalDigit](https://www.caldigit.com/thunderbolt-3-security-at-issue-due-to-thunderclap-threat-stay-protected-with-caldigit/#:~:text=Thunderclap%20should%20not%20be%20an,on%20the%20side%20of%20caution)).
- **Use Trusted Devices/Cables:** Avoid connecting unknown or untrusted Thunderbolt accessories to your computers. In your case, both the hub and the SSD are trusted hardware that you own. Be cautious if ever plugging them into other unknown systems or vice-versa.
- **Operating System Updates:** Keep your MacOS updated to the latest version, as Apple continually improves security around Thunderbolt and USB. According to CalDigit, updating to the latest Mac OS firmware addressed the Thunderclap Thunderbolt vulnerability on Macs ([Thunderbolt 3 Security at Issue due to Thunderclap Threat – Stay Protected with CalDigit – CalDigit](https://www.caldigit.com/thunderbolt-3-security-at-issue-due-to-thunderclap-threat-stay-protected-with-caldigit/#:~:text=Thunderclap%20should%20not%20be%20an,on%20the%20side%20of%20caution)).
- **Observe Device Behavior:** It’s rare, but if a peripheral ever starts acting strangely (e.g. a storage device presenting itself as a keyboard or network device out of nowhere, which is a sign of a BadUSB attack ([What is BadUSB | How to Protect Against BadUSB Attacks - ManageEngine Device Control Plus
](https://www.manageengine.com/device-control/badusb.html#:~:text=What%20is%20BadUSB%3F))), disconnect it. In normal operation, your external SSD should only function as a storage volume, and your hub should only act as a hub/adapter. Unusual behavior would be a red flag.

## Safe Transition to macOS – Risk Assessment
With the malware removal steps completed, transitioning these devices to a Mac environment is **low risk and likely safe**. There are a few reasons for this conclusion:

- **No Residual File Infection:** The Sandisk G40 drive has been completely erased and re-partitioned. It should now be as clean as a brand-new drive from the factory. There are no hidden files or Windows executables left on it that could pose a threat. Even if, hypothetically, something malicious somehow remained on the drive, it would be in a form that targets Windows (as Wacatac is a Windows trojan). Such a file would simply be inert on macOS unless you explicitly ran it under a compatibility layer. On macOS, you’ll likely reformat the SSD to APFS or HFS+, which will again overwrite the file system structures and ensure nothing remains of any NTFS or exFAT malware artifacts.

- **No Firmware Malware Indicated:** All evidence suggests the Trojan was a normal Windows infection without any firmware component. You’ve replaced the firmware on the one device that could be updated (the hub), and the other device (the SSD) doesn’t show any sign of abnormal behavior. If Wacatac had somehow compromised the SSD’s firmware (again, exceedingly improbable), it would likely try to behave as a BadUSB or otherwise cause detectable issues. There have been *no symptoms* of that kind of issue reported. Security forums note that while firmware implants in peripherals are possible, they tend to be seen only in highly targeted attacks ([firmware - I want to buy a used docking station for my laptop. Has there ever been a case of a docking station being a security concern? - Information Security Stack Exchange](https://security.stackexchange.com/questions/236510/i-want-to-buy-a-used-docking-station-for-my-laptop-has-there-ever-been-a-case-o#:~:text=Supply%20chain%20attacks%20are%20not,term%20support)) – for an average user, the chances are essentially zero.

- **Platform Change Advantage:** Moving to macOS also naturally distances you from the original threat. Wacatac cannot run on macOS, and any Windows-specific malware would not be able to auto-execute on a Mac. MacOS has different architecture and requires malware to be written for Mac to have any effect. Thus, even in the extremely unlikely event that something remained on the external SSD (say an old Windows DLL in some corner), it would not infect your Mac system. At worst, it would sit as a dormant file which would be harmless unless you deliberately forwarded it to a Windows machine and ran it.

In short, **the risk of Trojan:Win32/Wacatac persisting on your Sandisk external SSD or CalDigit Thunderbolt hub after the steps you performed is effectively *near zero***. All known persistence mechanisms of Wacatac (which are OS-based) have been mitigated, and it is not known to have any of the exotic firmware-persistence capabilities that would be required to survive the cleansing you’ve done ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=The%20trojan%20usually%20copies%20itself,com)) ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=implant%20for%20persistence%20,trojan%20as%20a%20second%02stage%20payload)). You have been very thorough, and there is no sign of infection remaining.

**Recommendation:** You can confidently use the SSD and hub with your Mac. No further special steps are needed beyond what you’ve done. As a final sanity check, you could always enable an antivirus scan on the Mac and scan the external SSD the first time you connect it, but given the clean state of the drive, this would mostly be for peace of mind. Going forward, continue practicing good security hygiene: keep macOS and device firmware up to date, and only use software and devices you trust. With these precautions, your devices should remain clean. The transition to macOS should be smooth and safe, and you’ve done everything necessary to ensure the Trojan is gone.

**Sources:**

- BlackBerry Threat Intelligence Report 2021 – *Trojan:Win32/Wacatac description and behavior* ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Examples%20include%20gathering%20personal%20and,com)) ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=Being%20a%20generic%20trojan%20detection%2C,specific%20trojan%20aliases))  
- PCRisk Security Portal – *Wacatac Trojan overview (data theft and malware capabilities)* ([Wacatac Trojan - Malware removal instructions (updated)](https://www.pcrisk.com/removal-guides/15409-wacatac-trojan#:~:text=These%20trojans%20can%20do%20extensive,as%20much%20revenue%20as%20possible))  
- Microsoft Support Knowledge Base – *Full format behavior in modern Windows (zero-filling disk)* ([Change in the behavior of the format command in Windows Vista and later versions - Windows Server | Microsoft Learn](https://learn.microsoft.com/en-us/previous-versions/troubleshoot/windows-server/format-command-not-write-zeros-to-disk#:~:text=The%20behavior%20of%20the%20format,a%20full%20format%20is%20performed))  
- BlackBerry (Eclypsium) Research – *TrickBot’s UEFI firmware persistence example* ([](https://www.commaxx.dk/getfile.php/137781-1614241302/Bilder/Norge/NO%20-%20Dokumenter/BlackBerry%202021%20Threat%20Report.pdf#:~:text=implant%20for%20persistence%20,trojan%20as%20a%20second%02stage%20payload))  
- CalDigit Advisory – *Thunderbolt (Thunderclap) security recommendations* ([Thunderbolt 3 Security at Issue due to Thunderclap Threat – Stay Protected with CalDigit – CalDigit](https://www.caldigit.com/thunderbolt-3-security-at-issue-due-to-thunderclap-threat-stay-protected-with-caldigit/#:~:text=Thunderclap%20revealed%20that%20the%20Thunderbolt,files%2C%20or%20run%20malicious%20code)) ([Thunderbolt 3 Security at Issue due to Thunderclap Threat – Stay Protected with CalDigit – CalDigit](https://www.caldigit.com/thunderbolt-3-security-at-issue-due-to-thunderclap-threat-stay-protected-with-caldigit/#:~:text=Thunderclap%20should%20not%20be%20an,on%20the%20side%20of%20caution))  
- Apple Support – *macOS requirement to allow new Thunderbolt/USB accessories (security feature)* ([If your Mac asks you to allow an accessory to connect - Apple Support](https://support.apple.com/en-us/102282#:~:text=Support%20support,laptop%20computer%20with%20Apple%20silicon))  
- Security StackExchange – *Discussion on docking station malware likelihood (firmware attacks are difficult and rare)* ([firmware - I want to buy a used docking station for my laptop. Has there ever been a case of a docking station being a security concern? - Information Security Stack Exchange](https://security.stackexchange.com/questions/236510/i-want-to-buy-a-used-docking-station-for-my-laptop-has-there-ever-been-a-case-o#:~:text=While%20I%20have%20never%20looked,and%20capable%20of%20soldering%20wires)) ([firmware - I want to buy a used docking station for my laptop. Has there ever been a case of a docking station being a security concern? - Information Security Stack Exchange](https://security.stackexchange.com/questions/236510/i-want-to-buy-a-used-docking-station-for-my-laptop-has-there-ever-been-a-case-o#:~:text=Supply%20chain%20attacks%20are%20not,term%20support))  
- Ars Technica – *Thunderstrike 2 research (malicious Thunderbolt device firmware spreading to Macs)*